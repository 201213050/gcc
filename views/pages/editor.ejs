<!DOCTYPE html>
<html lang="en">
<head>
	<% include ../partials/head %>
</head>
	<body class="container bg-info">
        <div class="text-center bg-danger text-white ">
            <h1>GCC Compiler</h1>
            <p>Participar en Lección</p> 
        </div> 
		<header>
            <% include ../partials/headerE %>
        </header>                
        <div class="custom-file">            
            <input type ="file" id = "archivo" name= "archivo" onchange="nuevo()" class = "custom-file-input">            
            <label class="custom-file-label" for="inputGroupFile01">Abrir Archivo</label>
        </div>        
          

        <!--<button class="btn btn-danger" onclick="nuevo()">+</button>-->


        <nav id="archivos">
            <div class="nav nav-tabs" id="nav-tab" role="tablist">
                <!--                -->
              <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Home</a>
              <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">Profile</a>
              <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-contact" role="tab" aria-controls="nav-contact" aria-selected="false">Contact</a>
            </div>
        </nav>
        <div class="tab-content" id="tab-content"  >
            <!--             -->     
            <div class="tab-pane fade" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                <textarea id="AcercaDe" rows="8" name="AcercaDe">

                </textarea>                
            </div>
            <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab"><a href="#">XXXX</a></div>
            <div class="tab-pane fade" id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab"><h1>Que onda</h1></div>   
        </div>
    </body>
    <script>          
        
        
        /*document.getElementById('archivo')
            .addEventListener('change', leerArchivo, false);        
        */
        
        function nuevo() 
        {         
            var path = document.getElementById('archivo').value;            
            var partes = path.split("\\");
            //alert(partes.length);
            var sub = partes[2];
            var subP = sub.split(".");
            var id = subP[0];
            var nav = document.getElementById('nav-tab'); 
            //alert(list.className);              
            var titulo = document.createElement('a');
            titulo.className = "nav-item nav-link";
            titulo.id = "nav-"+sub+"-tab";
            titulo.setAttribute("data-toggle","tab");
            titulo.setAttribute("href" , "#nav-" +sub );
            titulo.setAttribute("role","tab");
            titulo.setAttribute("aria-controls","nav-"+id);
            titulo.setAttribute("aria-selected","true"); 
            var textnode = document.createTextNode(sub);
            titulo.appendChild(textnode);
            //document.getElementById("titulo").appendChild(titulo);
            /*         
            */
            /* 
            titulo.onclick = function()
                {                    
                    var lista = document.getElementById("archivos").getElementsByTagName("li");                    
                    var i;
                    for (i = 0; i < lista.length; i++) 
                    { 
                        //lista[i].className = "nav-item nav-link ";
                        //lista[i].setAttribute("aria-selected","false");
                    }                    
                }            
            */            
            nav.appendChild(titulo);       
                        
            // Ahora agregamos area de disposición                         
            var contenedorPaginas = document.getElementById('tab-content');  // Tabla contenedora de archivos.
            /*Pestaña contenedor de los elementos del archivo.*/
            var contEdicion = document.createElement('div');
            contEdicion.className = "tab-pane fade";
            contEdicion.id = 'nav-'+sub;
            contEdicion.setAttribute("role","tabpanel");
            contEdicion.setAttribute("aria-labelledby", "nav-"+sub+"-tab");
            contEdicion.setAttribute("aria-controls","nav-"+sub); 
            contEdicion.setAttribute("aria-selected","false");
            /*Contenedor de area de edicion, debuger y reportes.*/
            var contenedor = document.createElement('div');
            contenedor.className = "container";
            /*Primer fila de la tabla*/
            var contenedorTexto = document.createElement('div');
            contenedorTexto.className = "row";
            /*Primer columna Editor*/
            var columnaEditor = document.createElement('div');
            columnaEditor.className = "col-6";            
            /*Segunda columna Debugger*/
            var columnaDeb = document.createElement('div');
            columnaDeb.className = "col-6";                
            var contenedorEditor = document.createElement('div');
            /*Editor de texto */
            var editor = document.createElement('TEXTAREA');
            editor.id = sub ;
            editor.setAttribute("rows","8");
            editor.value =sub;                                      
            /*Editor de debugger*/
            var editorD = document.createElement('TEXTAREA');
            editorD.id = sub+"D" ;
            editorD.setAttribute("rows","8");
            editorD.value =sub+"Debugger";            
            
            columnaEditor.appendChild(editor);
            columnaDeb.append(editorD);
            
            contenedorTexto.appendChild(columnaEditor);
            contenedorTexto.appendChild(columnaDeb);
            contenedor.appendChild(contenedorTexto);
            contEdicion.appendChild(contenedor);
            contenedorPaginas.appendChild(contEdicion);

            prepararArea(editorD.id);
            prepararArea(editor.id);

            
            /*
                <div class="container">
                <div class="row">
                    <div class="col">
                    1 of 2
                    </div>
                    <div class="col">
                    2 of 2
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                    1 of 3
                    </div>
                    <div class="col">
                    2 of 3
                    </div>
                    <div class="col">
                    3 of 3
                    </div>
                </div>
                </div>            
            */                           
        }      

        function leerArchivo(e) 
        {            
            var archivo = e.target.files[0];
            alert(archivo);
            if (!archivo) {
                return;
            }
            var lector = new FileReader();
            lector.onload = function(e) 
            {
                var contenido = e.target.result;
                mostrarContenido(contenido);
            };
            lector.readAsText(archivo);
        }

        function mostrarContenido(contenido) 
        {
            alert(contenido);
            var elemento = document.getElementById('contenido-archivo');
            elemento.innerHTML = contenido;
        }

        
        function prepararArea(area)
        {
            var cEditor = CodeMirror.fromTextArea(document.getElementById(area),
            //var cEditor = CodeMirror.fromTextArea(area,
            {
            lineNumbers: true,
            matchBrackets: true,
            mode: "text/x-java"
            });             
        }                
    </script>  
</html>